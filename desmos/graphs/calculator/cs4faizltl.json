{"hash":"cs4faizltl","parent_hash":null,"thumbUrl":"https://www.desmos.com/calc_thumbs/production/cs4faizltl.png","stateUrl":"https://www.desmos.com/calc-states/production/cs4faizltl","title":"Orthogonal linear regression","access":"link","created":"Fri, 11 Feb 2022 04:20:21 GMT","state":{"version":9,"randomSeed":"7dba517010a23c51237cca1134f21542","graph":{"viewport":{"xmin":-2.111825498973324,"ymin":-1.5647187720359819,"xmax":3.4873268241293727,"ymax":3.315937974953756}},"expressions":{"list":[{"type":"text","id":"46","text":"Compare different ways to fit a straight line to a set of points.\nDrag the black point to set data"},{"type":"text","id":"87","text":"The red line (linear regression) doesn't work well for nearly-vertical lines.\nThe blue line sometimes has weird behaviors.\nThe two green lines are identical, which are calculated by minimizing the sum of squares of orthogonal distances. I like the Lagrange multiplier version more."},{"type":"expression","id":"64","color":"#6042a6"},{"type":"folder","id":"7","title":"Reference line","collapsed":true},{"type":"expression","id":"1","folderId":"7","color":"#c74440","latex":"a_{0}=0.34"},{"type":"expression","id":"2","folderId":"7","color":"#2d70b3","latex":"b_{0}=-1.04"},{"type":"expression","id":"4","folderId":"7","color":"#fa7e19","latex":"\\left(a_{0},0\\right)"},{"type":"expression","id":"5","folderId":"7","color":"#fa7e19","latex":"\\left(0,b_{0}\\right)"},{"type":"expression","id":"3","folderId":"7","color":"#fa7e19","latex":"\\frac{x}{a_{0}}+\\frac{y}{b_{0}}=1","lineStyle":"DASHED"},{"type":"folder","id":"9","title":"Generate random data","collapsed":true},{"type":"expression","id":"10","folderId":"9","color":"#388c46","latex":"N=65","slider":{"hardMin":true,"hardMax":true,"min":"2","max":"1000"}},{"type":"text","id":"15","folderId":"9","text":"Generate normally distributed points"},{"type":"expression","id":"19","folderId":"9","color":"#000000","latex":"n_{c}=\\left(1.19,0.95\\right)"},{"type":"expression","id":"11","folderId":"9","color":"#6042a6","latex":"X_{n0}=\\operatorname{normaldist}\\left(n_{c}.x,1\\right).\\operatorname{inversecdf}\\left(\\operatorname{random}\\left(N\\right)\\right)"},{"type":"expression","id":"12","folderId":"9","color":"#000000","latex":"Y_{n0}=\\operatorname{normaldist}\\left(n_{c}.y,1\\right).\\operatorname{inversecdf}\\left(\\operatorname{random}\\left(N\\right)\\right)"},{"type":"text","id":"17","folderId":"9","text":"Project them on the line with some (not so good) variation"},{"type":"expression","id":"26","folderId":"9","color":"#2d70b3","latex":"e_{nl}=\\operatorname{normaldist}\\left(0,0.4\\tanh\\left(\\frac{b_{0}n_{c}.x+a_{0}n_{c}.y-a_{0}b_{0}}{a_{0}^{2}+b_{0}^{2}}\\right)\\right).\\operatorname{inversecdf}\\left(\\operatorname{random}\\left(N\\right)\\right)"},{"type":"expression","id":"24","folderId":"9","color":"#fa7e19","latex":"P=\\left(X_{n0},Y_{n0}\\right)+\\frac{a_{0}b_{0}-a_{0}Y_{n0}-b_{0}X_{n0}}{a_{0}^{2}+b_{0}^{2}}\\left(b_{0},a_{0}\\right)\\left(1+e_{nl}\\right)"},{"type":"expression","id":"34","folderId":"9","color":"#c74440","latex":"X=P.x"},{"type":"expression","id":"35","folderId":"9","color":"#2d70b3","latex":"Y=P.y"},{"type":"expression","id":"47","color":"#c74440"},{"type":"folder","id":"29","title":"Linear regression (red)","collapsed":true},{"type":"text","id":"40","folderId":"29","text":"Built-in"},{"type":"expression","id":"32","folderId":"29","color":"#c74440","latex":"Y\\sim m_{1}X+d_{1}","residualVariable":"e_{1}","regressionParameters":{"m_{1}":1.7935039840987306,"d_{1}":-0.1619273608136583}},{"type":"text","id":"42","folderId":"29","text":"Manually"},{"type":"expression","id":"43","folderId":"29","color":"#388c46","latex":"m_{2}=\\frac{N\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)}{N\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)^{2}}"},{"type":"expression","id":"44","folderId":"29","color":"#6042a6","latex":"d_{2}=\\frac{\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)}{N\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)^{2}}"},{"type":"expression","id":"45","folderId":"29","color":"#c74440","latex":"y=m_{2}x+d_{2}"},{"type":"folder","id":"51","title":"Implicit least square fitting (blue)","collapsed":true},{"type":"text","id":"54","folderId":"51","text":"Built-in (numerical)"},{"type":"expression","id":"36","folderId":"51","color":"#388c46","latex":"\\frac{X}{a_{1}}+\\frac{Y}{b_{1}}\\sim1","residualVariable":"e_{2}","regressionParameters":{"a_{1}":0.7583872966649611,"b_{1}":-15.19243526630738}},{"type":"expression","id":"33","folderId":"51","color":"#2d70b3","latex":"\\frac{x}{a_{1}}+\\frac{y}{b_{1}}=1"},{"type":"text","id":"58","folderId":"51","text":"Analytical, minimize sum[(xi/a+yi/b+c)\u00b2] subject to c=-1"},{"type":"expression","id":"59","folderId":"51","color":"#6042a6","latex":"a_{2}=\\frac{\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)^{2}}{\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)}"},{"type":"expression","id":"62","folderId":"51","color":"#2d70b3","latex":"b_{2}=\\frac{\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)^{2}}{\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)}"},{"type":"expression","id":"63","folderId":"51","color":"#2d70b3","latex":"\\frac{x}{a_{2}}+\\frac{y}{b_{2}}=1"},{"type":"folder","id":"65","title":"Orthogonal least square, parameterize unit vector using trigs (green)","collapsed":true},{"type":"expression","id":"66","folderId":"65","color":"#000000","latex":"s_{tx}=\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)^{2}-\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)^{2}+N\\left(\\sum_{i=1}^{N}Y\\left[i\\right]^{2}\\right)-N\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)"},{"type":"expression","id":"69","folderId":"65","color":"#388c46","latex":"s_{ty}=2\\left(N\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)\\right)"},{"type":"expression","id":"70","folderId":"65","color":"#6042a6","latex":"t_{t0}=-\\arctan\\left(\\frac{s_{ty}}{s_{tx}}\\right)"},{"type":"expression","id":"72","folderId":"65","color":"#c74440","latex":"t_{t}=\\frac{1}{2}\\left(t_{t0}+\\left\\{s_{tx}\\cos\\left(t_{t0}\\right)<s_{ty}\\sin\\left(t_{t0}\\right):\\pi,0\\right\\}\\right)"},{"type":"expression","id":"73","folderId":"65","color":"#2d70b3","latex":"a_{t}=\\cos\\left(t_{t}\\right)"},{"type":"expression","id":"74","folderId":"65","color":"#388c46","latex":"b_{t}=\\sin\\left(t_{t}\\right)"},{"type":"expression","id":"75","folderId":"65","color":"#6042a6","latex":"c_{t}=-\\frac{1}{N}\\left(a_{t}\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)+b_{t}\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)\\right)"},{"type":"expression","id":"76","folderId":"65","color":"#388c46","latex":"a_{t}x+b_{t}y+c_{t}=0"},{"type":"folder","id":"77","title":"Orthogonal least square, unit vector constraint using Lagrange multiplier (green)"},{"type":"text","id":"85","folderId":"77","text":"k = a/b-b/a, solve quadratic equation"},{"type":"expression","id":"83","folderId":"77","color":"#c74440","latex":"m_{l}=N\\left(\\sum_{i=1}^{N}X\\left[i\\right]Y\\left[i\\right]\\right)-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)"},{"type":"expression","id":"78","folderId":"77","color":"#c74440","latex":"k_{l}=\\frac{1}{m_{l}}\\left(N\\left(\\sum_{i=1}^{N}X\\left[i\\right]^{2}\\right)-N\\left(\\sum_{i=1}^{N}Y\\left[i\\right]^{2}\\right)+\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)^{2}-\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)^{2}\\right)"},{"type":"expression","id":"79","folderId":"77","color":"#2d70b3","latex":"a_{l}=k_{l}-\\operatorname{sign}\\left(m_{l}\\right)\\cdot\\sqrt{k_{l}^{2}+4}"},{"type":"expression","id":"80","folderId":"77","color":"#388c46","latex":"b_{l}=2\\cdot10^{0}"},{"type":"expression","id":"81","folderId":"77","color":"#6042a6","latex":"c_{l}=-\\frac{1}{N}\\left(a_{l}\\left(\\sum_{i=1}^{N}X\\left[i\\right]\\right)+b_{l}\\left(\\sum_{i=1}^{N}Y\\left[i\\right]\\right)\\right)"},{"type":"expression","id":"82","folderId":"77","color":"#388c46","latex":"a_{l}x+b_{l}y+c_{l}=0"}]}}}