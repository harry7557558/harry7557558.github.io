{"hash":"3rcvejfjsh","parent_hash":"fjwyqyiftxpi3vjib9n9","thumbUrl":"https://www.desmos.com/calc_thumbs/production/3rcvejfjsh.png","stateUrl":"https://www.desmos.com/calc-states/production/3rcvejfjsh","title":"Value Noise Distribution","access":"link","created":"Sun, 17 Jul 2022 03:30:14 GMT","state":{"version":9,"randomSeed":"0183b52f775ea8fc0092dc4f37bb4f2e","graph":{"viewport":{"xmin":-0.565802871613694,"ymin":-0.2213446228201612,"xmax":1.5567536452487987,"ymax":1.4562399121852592}},"expressions":{"list":[{"type":"text","id":"107","text":"Attempt to produce 1-dimensional noise functions with values uniformly distributed between 0 and 1.\nThe idea is to find the distribution of the value noise and apply its CDF to the range of the function."},{"type":"text","id":"109","text":"Basic idea:\n - Given three uniform random variables U, V, T, one is interested in finding the distribution: U(1-T)+VT or U*(1-smoothstep(T))+V*smoothstep(t)\n - Treat T as a constant and find the PDF of the weighted sum of U and V, which is a probability convolution that involves integrating piecewise functions\n - Integrate variable T to get the PDF of the output\nCredit to @spinwave in the public Desmos Discord server."},{"type":"text","id":"111","text":"In the linear interpolation version, PDF and CDF are exact. In the smoothstep version, PDF is exact and CDF is approximation."},{"type":"expression","id":"106","color":"#2d70b3"},{"type":"folder","id":"104","title":"Generate random numbers (U, V, T)","collapsed":true},{"type":"expression","id":"42","folderId":"104","color":"#000000","latex":"N=10000","labelSize":"medium","slider":{"hardMin":true,"hardMax":true,"min":"10","max":"10000","step":"1"}},{"type":"expression","id":"43","folderId":"104","color":"#c74440","latex":"U=\\operatorname{random}\\left(N\\right)"},{"type":"expression","id":"44","folderId":"104","color":"#2d70b3","latex":"V=\\operatorname{random}\\left(N\\right)"},{"type":"expression","id":"46","folderId":"104","color":"#6042a6","latex":"T=\\operatorname{random}\\left(N\\right)"},{"type":"expression","id":"70","color":"#c74440"},{"type":"folder","id":"51","title":"Linear interpolation value noise distribution\nExact PDF and CDF, credit to @spinwave","hidden":true,"collapsed":true},{"type":"text","id":"113","folderId":"51","text":"Result of the convolution after some tedious piecewise work"},{"type":"expression","id":"18","folderId":"51","color":"#388c46","latex":"f_{1}\\left(x,t\\right)=\\left\\{t<x:\\frac{1}{1-t},\\frac{x}{t\\left(1-t\\right)}\\right\\}\\left\\{x<0.5\\right\\}"},{"type":"expression","id":"6","folderId":"51","color":"#c74440","latex":"f_{1}\\left(x,0.3\\right)"},{"type":"text","id":"79","folderId":"51","text":"PDF"},{"type":"expression","id":"3","folderId":"51","color":"#388c46","latex":"2\\int_{0}^{\\frac{1}{2}}f_{1}\\left(x,t\\right)dt","labelSize":"medium"},{"type":"expression","id":"4","folderId":"51","color":"#6042a6","latex":"F_{1}\\left(x\\right)=-2\\left(x\\ln\\left(x\\right)+\\left(1-x\\right)\\ln\\left(1-x\\right)\\right)"},{"type":"text","id":"81","folderId":"51","text":"CDF"},{"type":"expression","id":"82","folderId":"51","color":"#388c46","latex":"C_{1}\\left(x\\right)=0.5-x^{2}\\left(\\ln\\left(x\\right)-\\frac{1}{2}\\right)+\\left(1-x\\right)^{2}\\left(\\ln\\left(1-x\\right)-\\frac{1}{2}\\right)"},{"type":"text","id":"84","folderId":"51","text":"Plot histogram"},{"type":"expression","id":"85","folderId":"51","color":"#000000","latex":"X_{1}=U\\left(1-T\\right)+VT"},{"type":"expression","id":"86","folderId":"51","color":"#2d70b3","latex":"\\operatorname{histogram}\\left(X_{1},0.05\\right)","vizProps":{"binAlignment":"left","histogramMode":"density"}},{"type":"expression","id":"87","folderId":"51","color":"#6042a6","latex":"\\operatorname{histogram}\\left(C_{1}\\left(X_{1}\\right),0.05\\right)","vizProps":{"binAlignment":"left","histogramMode":"density"}},{"type":"expression","id":"52","color":"#6042a6"},{"type":"folder","id":"56","title":"Smoothstep interpolation value noise distribution\nPDF is exact, CDF is approximation","collapsed":true},{"type":"expression","id":"23","folderId":"56","color":"#388c46","latex":"t_{3}\\left(t\\right)=3t^{2}-2t^{3}","labelSize":"medium"},{"type":"expression","id":"25","folderId":"56","color":"#000000","latex":"t_{3i}\\left(t\\right)=\\frac{1}{2}-\\sin\\left(\\frac{\\arcsin\\left(1-2t\\right)}{3}\\right)"},{"type":"expression","id":"17","folderId":"56","color":"#2d70b3","latex":"f_{3}\\left(x,t\\right)=\\left\\{t_{3}\\left(t\\right)<x:\\frac{1}{1-t_{3}\\left(t\\right)},\\frac{x}{t_{3}\\left(t\\right)\\left(1-t_{3}\\left(t\\right)\\right)}\\right\\}\\left\\{x<0.5\\right\\}","labelSize":"medium"},{"type":"expression","id":"21","folderId":"56","color":"#c74440","latex":"f_{3}\\left(x,0.3\\right)","labelSize":"medium"},{"type":"text","id":"36","folderId":"56","text":"Generated by the online integral calculator - https://www.integral-calculator.com/"},{"type":"expression","id":"30","folderId":"56","color":"#000000","latex":"G_{31}\\left(x\\right)=\\frac{2}{9}\\left(\\ln\\left(2x+1\\right)-\\ln\\left(1-x\\right)\\right)-\\frac{1}{3\\left(x-1\\right)}","hidden":true},{"type":"expression","id":"27","folderId":"56","color":"#2d70b3","latex":"G_{32}\\left(x\\right)=\\frac{2}{9}\\left(\\ln\\left(2x+1\\right)-\\ln\\left(3-2x\\right)+\\ln\\left(x\\right)-\\ln\\left(1-x\\right)\\right)-\\frac{1}{3}\\left(\\frac{1}{x}+\\frac{1}{x-1}\\right)","hidden":true},{"type":"text","id":"38","folderId":"56","text":"PDF"},{"type":"expression","id":"34","folderId":"56","color":"#6042a6","latex":"2\\left(G_{31}\\left(t_{3i}\\left(x\\right)\\right)-G_{31}\\left(0\\right)+xG_{32}\\left(\\frac{1}{2}\\right)-xG_{32}\\left(t_{3i}\\left(x\\right)\\right)\\right)"},{"type":"expression","id":"39","folderId":"56","color":"#2d70b3","latex":"F_{3}\\left(x\\right)=2\\left(G_{31}\\left(t_{3i}\\left(x\\right)\\right)-xG_{32}\\left(t_{3i}\\left(x\\right)\\right)-\\frac{1}{3}\\right)"},{"type":"expression","id":"24","folderId":"56","color":"#6042a6","latex":"2\\int_{0}^{\\frac{1}{2}}f_{3}\\left(x,t\\right)dt","hidden":true},{"type":"text","id":"66","folderId":"56","text":"Approximate it with a function that is easier to integrate\nThe order of power is empirically 0.5, so use a root function."},{"type":"expression","id":"59","folderId":"56","color":"#6042a6","latex":"10^{-12}\\frac{F_{3}'\\left(10^{-12}\\right)}{F_{3}\\left(10^{-12}\\right)}"},{"type":"expression","id":"67","folderId":"56","color":"#c74440","latex":"\\frac{8}{\\pi}\\sqrt{x\\left(1-x\\right)}"},{"type":"expression","id":"68","folderId":"56","color":"#2d70b3","latex":"C_{3}\\left(x\\right)=\\frac{1}{2}+\\frac{1}{\\pi}\\left(\\arcsin\\left(2x-1\\right)+\\left(4x-2\\right)\\sqrt{x\\left(1-x\\right)}\\right)"},{"type":"text","id":"72","folderId":"56","text":"Plot histogram"},{"type":"expression","id":"47","folderId":"56","color":"#000000","latex":"X_{3}=U+\\left(V-U\\right)\\left(3T^{2}-2T^{3}\\right)"},{"type":"expression","id":"49","folderId":"56","color":"#2d70b3","latex":"\\operatorname{histogram}\\left(X_{3},0.05\\right)","labelSize":"medium","vizProps":{"binAlignment":"left","histogramMode":"density"}},{"type":"expression","id":"69","folderId":"56","color":"#6042a6","latex":"\\operatorname{histogram}\\left(C_{3}\\left(X_{3}\\right),0.05\\right)","vizProps":{"binAlignment":"left","histogramMode":"density"}},{"type":"expression","id":"41","color":"#6042a6"},{"type":"folder","id":"91","title":"Plot noise functions","hidden":true,"collapsed":true},{"type":"expression","id":"92","folderId":"91","color":"#000000","latex":"h_{ash}\\left(x\\right)=\\operatorname{mod}\\left(43758.5453\\sin\\left(12.9898x+78.233\\right),1\\right)","hidden":true},{"type":"expression","id":"93","folderId":"91","color":"#c74440","latex":"n_{0}\\left(x\\right)=h_{ash}\\left(\\operatorname{floor}\\left(x\\right)\\right)","hidden":true,"labelSize":"medium"},{"type":"expression","id":"94","folderId":"91","color":"#2d70b3","latex":"n_{1}\\left(x\\right)=n_{0}\\left(x\\right)\\left(1-\\operatorname{mod}\\left(x,1\\right)\\right)+n_{0}\\left(x+1\\right)\\operatorname{mod}\\left(x,1\\right)","hidden":true,"labelSize":"medium"},{"type":"expression","id":"100","folderId":"91","color":"#388c46","latex":"k_{f}=16.15","slider":{"hardMin":true,"hardMax":true,"min":"0","max":"20"}},{"type":"expression","id":"95","folderId":"91","color":"#388c46","latex":"n_{1}\\left(k_{f}x\\right)","hidden":true},{"type":"expression","id":"96","folderId":"91","color":"#6042a6","latex":"C_{1}\\left(n_{1}\\left(k_{f}x\\right)\\right)"},{"type":"expression","id":"97","folderId":"91","color":"#000000","latex":"n_{3}\\left(x\\right)=n_{0}\\left(x\\right)\\left(1-t_{3}\\left(\\operatorname{mod}\\left(x,1\\right)\\right)\\right)+n_{0}\\left(x+1\\right)t_{3}\\left(\\operatorname{mod}\\left(x,1\\right)\\right)","hidden":true},{"type":"expression","id":"98","folderId":"91","color":"#c74440","latex":"n_{3}\\left(k_{f}x\\right)","hidden":true},{"type":"expression","id":"99","folderId":"91","color":"#2d70b3","latex":"C_{3}\\left(n_{3}\\left(k_{f}x\\right)\\right)"}]}}}