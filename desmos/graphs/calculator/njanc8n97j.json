{"hash":"njanc8n97j","parent_hash":"3nd1udooqe","thumbUrl":"https://www.desmos.com/calc_thumbs/production/njanc8n97j.png","stateUrl":"https://www.desmos.com/calc-states/production/njanc8n97j","title":"Truss Solver","access":"link","created":"2024-12-21T05:43:11.671Z","product":"graphing","state":{"version":11,"randomSeed":"b03f2fede042958609e7352a303f8578","graph":{"viewport":{"xmin":-6.155610331584431,"ymin":-1.5421336386720528,"xmax":6.158370859207431,"ymax":6.880337175801313}},"expressions":{"list":[{"type":"text","id":"181","text":"Truss solver -\n\nA truss in civil engineering is beams (known as members) connected to nodes. You see trusses in famous structures like the Eiffel tower and the Golden Gate Bridge. Given a truss design, how do we know if it's safe? A civil engineer may answer: do a structural analysis.\n\nTo simplify, each node has a downward force caused by gravity, which is the case if you assume people/cars are light and wind isn't strong. (well, members also have weights, but in that case you can equivalently distribute them to nodes at their endpoints.) Each member holds a force between connected nodes (tension or compression), and for safety we are interested in this force since a member may break if the force is too large. You may have heard of Hooke's law for springs from your physics class: F = k * \u0394l, where \u0394l is change in spring length and k is a constant related to the spring. Members are also like springs, but for trusses we often use F = k * \u0394l / l, to accommodate members with different lengths but made with same material and cross section. (To get an intuition of this equation, you can imagine a shorter spring is stiffer and therefore has a larger spring constant k / l and vice versa.)\n\nThis example finds forces in each member of a truss using Hooke's law. In real-world trusses, nodes often deflect (aka. move) very little, so we assume member lengths are constant and only care about \u0394l. In this case, we have a linear model. We can find a matrix that maps node deflections to node forces all at once, and if we know the forces at each node, we can solve a linear system to get the deflections at each node, and then find forces in each member using Hooke's law. But - the matrix can be very large (there can be lots of nodes!) and the linear system can be very slow to solve. How do we handle this? See this graph."},{"type":"expression","id":"186","color":"#000000"},{"type":"text","id":"185","text":"Black circle is node, larger circle is larger weight\n\nX is fixed node (they don't move)\n\nLines are members, blueish is compression and reddish is tension\n\nDeflections are exaggerated for visual - they don't move that much in real world"},{"type":"expression","id":"180","color":"#2d70b3"},{"type":"text","id":"188","text":"Click this to re-solve truss"},{"type":"expression","id":"155","color":"#388c46","latex":"r_{eCompute}=c_{gReset}"},{"type":"expression","id":"196","color":"#000000"},{"type":"folder","id":"263","title":"Truss definition and domain"},{"type":"text","id":"266","folderId":"263","text":"Nodes are points with integer coordinates and trussFunc<=0"},{"type":"expression","id":"197","folderId":"263","color":"#c74440","latex":"t_{russFunc}\\left(x,y\\right)=\\left|\\sqrt{x^{2}+y^{2}}-0.01x-4\\right|-1.01"},{"type":"expression","id":"198","folderId":"263","color":"#2d70b3","latex":"t_{russFunc}\\left(x,y\\right)\\le0\\left\\{y\\ge0\\right\\}","hidden":true},{"type":"text","id":"268","folderId":"263","text":"Only sample from -x[bound] to x[bound], 0 to y[bound]"},{"type":"expression","id":"199","folderId":"263","color":"#388c46","latex":"x_{bound}=5","slider":{"hardMin":true,"hardMax":true,"min":"1","step":"1"}},{"type":"expression","id":"200","folderId":"263","color":"#6042a6","latex":"y_{bound}=5","slider":{"hardMin":true,"hardMax":true,"min":"1","max":"20","step":"1"}},{"type":"expression","id":"201","folderId":"263","color":"#000000","latex":"\\max\\left(\\left|x\\right|-x_{bound},\\ y-y_{bound},\\ -y\\right)=0","lineStyle":"DASHED"},{"type":"expression","id":"264","color":"#6042a6"},{"type":"folder","id":"193","title":"Procedural truss generation"},{"type":"text","id":"270","folderId":"193","text":"Number of sampling nodes per dimension"},{"type":"expression","id":"194","folderId":"193","color":"#388c46","latex":"n_{sx}=2x_{bound}+1"},{"type":"expression","id":"202","folderId":"193","color":"#c74440","latex":"n_{sy}=y_{bound}+1"},{"type":"expression","id":"203","folderId":"193","color":"#2d70b3","latex":"n_{s}=n_{sx}n_{sy}"},{"type":"expression","id":"279","folderId":"193","color":"#388c46"},{"type":"text","id":"272","folderId":"193","text":"Sample nodes on a uniform grid"},{"type":"expression","id":"216","folderId":"193","color":"#6042a6","latex":"I_{ug}=\\left[\\left(\\operatorname{mod}\\left(i,n_{sx}\\right),\\operatorname{floor}\\left(\\frac{i}{n_{sx}}\\right)\\right)\\operatorname{for}i=\\left[0...n_{s}-1\\right]\\right]","hidden":true},{"type":"expression","id":"205","folderId":"193","color":"#6042a6","latex":"p_{ug}=I_{ug}-\\left(x_{bound},0\\right)","hidden":true},{"type":"expression","id":"204","folderId":"193","color":"#388c46","latex":"v_{ug}=\\left\\{t_{russFunc}\\left(p_{ug}.x,\\ p_{ug}.y\\right)\\le0:\\ 1,\\ 0\\right\\}"},{"type":"expression","id":"280","folderId":"193","color":"#6042a6"},{"type":"text","id":"274","folderId":"193","text":"Filter node points"},{"type":"expression","id":"231","folderId":"193","color":"#6042a6","latex":"k_{p}=\\left[1...n_{s}\\right]\\left[v_{ug}>\\frac{1}{2}\\right]"},{"type":"expression","id":"233","folderId":"193","color":"#c74440","latex":"k_{pi}=p_{refixSum}\\left(v_{ug}\\right)"},{"type":"expression","id":"229","folderId":"193","color":"#2d70b3","latex":"p_{p}=p_{ug}\\left[v_{ug}>0\\right]","hidden":true},{"type":"expression","id":"230","folderId":"193","color":"#388c46","latex":"I_{p}=I_{ug}\\left[v_{ug}>0\\right]","hidden":true},{"type":"expression","id":"222","folderId":"193","color":"#000000","latex":"P=1.0\\cdot p_{p}","hidden":true},{"type":"expression","id":"10","folderId":"193","color":"#6042a6","latex":"N=\\operatorname{length}\\left(P\\right)"},{"type":"expression","id":"223","folderId":"193","color":"#c74440","latex":"N_{fixed}=\\operatorname{total}\\left(\\left[v_{ug}\\left[i\\right]\\operatorname{for}i=\\left[1...n_{sx}\\right]\\right]\\right)"},{"type":"expression","id":"277","folderId":"193","color":"#c74440"},{"type":"text","id":"276","folderId":"193","text":"Sample all possible members"},{"type":"expression","id":"218","folderId":"193","color":"#c74440","latex":"f_{bound}\\left(i,j\\right)=\\max\\left(-i,\\ i-n_{sx}+1,\\ -j,\\ j-n_{sy}+1\\right)-\\frac{1}{2}"},{"type":"expression","id":"281","folderId":"193","color":"#000000","latex":"m_{idx0}\\left(k\\right)=k.y\\cdot n_{sx}+k.x+1"},{"type":"expression","id":"212","folderId":"193","color":"#000000","latex":"m_{has}\\left(k\\right)=\\left\\{f_{bound}\\left(k.x,k.y\\right)>0:\\ 0,\\ v_{ug}\\left[m_{idx0}\\left(k\\right)\\right]\\right\\}"},{"type":"expression","id":"213","folderId":"193","color":"#c74440","latex":"m_{dirs}=\\left[\\left(1,0\\right),\\left(1,1\\right),\\left(0,1\\right),\\left(-1,1\\right),\\left(-1,0\\right),\\left(-1,-1\\right),\\left(0,-1\\right),\\left(1,-1\\right)\\right]","hidden":true},{"type":"expression","id":"241","folderId":"193","color":"#388c46","latex":"l_{dirs}=\\operatorname{length}\\left(m_{dirs}\\right)"},{"type":"expression","id":"224","folderId":"193","color":"#2d70b3","latex":"m_{idx}\\left(i_{p},i_{m}\\right)=\\left\\{m_{has}\\left(I_{p}\\left[i_{p}\\right]+\\ m_{dirs}\\left[i_{m}\\right]\\right)>0:\\ \\left(i_{p},\\ k_{pi}\\left[m_{idx0}\\left(I_{p}\\left[i_{p}\\right]+m_{dirs}\\left[i_{m}\\right]\\right)\\right]\\right),\\ \\left(0,0\\right)\\right\\}"},{"type":"expression","id":"221","folderId":"193","color":"#6042a6","latex":"p_{m0}=\\left[m_{idx}\\left(\\operatorname{floor}\\left(\\frac{i}{l_{dirs}}\\right)+1,\\operatorname{mod}\\left(i,l_{dirs}\\right)+1\\right)\\operatorname{for}i=\\left[0...Nl_{dirs}-1\\right]\\right]","hidden":true},{"type":"expression","id":"225","folderId":"193","color":"#388c46","latex":"p_{p}\\left[p_{m0}.x\\right]\\left(1-t\\right)+p_{p}\\left[p_{m0}.y\\right]t","hidden":true},{"type":"expression","id":"250","folderId":"193","color":"#2d70b3"},{"type":"text","id":"239","folderId":"193","text":"Create CSR adjacency matrix for members"},{"type":"expression","id":"234","folderId":"193","color":"#2d70b3","latex":"A_{I}=p_{m0}\\left[p_{m0}\\cdot\\left(1,1\\right)>0\\right]","hidden":true},{"type":"expression","id":"237","folderId":"193","color":"#000000","latex":"A_{count}=\\left[\\sum_{j=1}^{l_{dirs}}m_{has}\\left(I_{p}\\left[i\\right]+\\ m_{dirs}\\left[j\\right]\\right)\\operatorname{for}i=\\left[1...N\\right]\\right]"},{"type":"expression","id":"242","folderId":"193","color":"#6042a6","latex":"A_{end}=p_{refixSum}\\left(A_{count}\\right)"},{"type":"expression","id":"240","folderId":"193","color":"#2d70b3","latex":"A_{start}=A_{end}-A_{count}+1"},{"type":"expression","id":"284","folderId":"193","color":"#388c46"},{"type":"text","id":"286","folderId":"193","text":"Applied forces at each node"},{"type":"expression","id":"58","folderId":"193","color":"#c74440","latex":"F=\\frac{A_{count}}{l_{dirs}}"},{"type":"expression","id":"144","folderId":"193","color":"#000000","latex":"F_{V}=\\left(0,-F\\right)","hidden":true},{"type":"expression","id":"154","color":"#2d70b3"},{"type":"folder","id":"135","title":"Visualization"},{"type":"text","id":"137","folderId":"135","text":"Original truss, highlight applied forces"},{"type":"expression","id":"3","folderId":"135","color":"#388c46","latex":"\\operatorname{polygon}\\left(P\\left[A_{I}.x\\right],P\\left[A_{I}.y\\right]\\right)\\left\\{A_{I}.x<A_{I}.y\\right\\}","lineStyle":"DASHED","lineOpacity":"0.5","lineWidth":"2"},{"type":"text","id":"132","folderId":"135","text":"Deflected truss - Reddish is tension, blueish is compression"},{"type":"expression","id":"105","folderId":"135","color":"#000000","latex":"P_{defl}=P+0.01\\cdot U","pointSize":"15F^{\\frac{1}{2}}","movablePointSize":"15F^{\\frac{1}{2}}"},{"type":"expression","id":"106","folderId":"135","color":"#c74440","latex":"\\operatorname{polygon}\\left(P_{defl}\\left[A_{I}.x\\right],P_{defl}\\left[A_{I}.y\\right]\\right)\\left\\{A_{I}.x<A_{I}.y\\right\\}","colorLatex":"m_{color}"},{"type":"expression","id":"129","folderId":"135","color":"#c74440","latex":"t_{mColor}=0.5+0.5\\frac{M_{F}}{\\max\\left(\\left|M_{F}\\right|\\right)}"},{"type":"expression","id":"297","folderId":"135","color":"#c74440","latex":"s_{color}\\left(c\\right)=255\\left(3c^{2}-2c^{3}\\right)","hidden":true,"slider":{"hardMin":true,"hardMax":true,"min":"0","max":"1"}},{"type":"expression","id":"130","folderId":"135","color":"#2d70b3","latex":"m_{color}=\\operatorname{rgb}\\left(s_{color}\\left(t_{mColor}\\right),\\ s_{color}\\left(0.4\\right),\\ s_{color}\\left(1-t_{mColor}\\right)\\right)"},{"type":"text","id":"289","folderId":"135","text":"Fixed points"},{"type":"expression","id":"133","folderId":"135","color":"#000000","latex":"P\\left[\\left[1...N_{fixed}\\right]\\right]","pointStyle":"CROSS","pointSize":"16","movablePointSize":"16"},{"type":"expression","id":"4","color":"#6042a6"},{"type":"folder","id":"6","title":"Stiffness matrix parameters for each member"},{"type":"expression","id":"39","folderId":"6","color":"#c74440","latex":"m_{d}=P\\left[A_{I}.y\\right]-P\\left[A_{I}.x\\right]","hidden":true},{"type":"expression","id":"17","folderId":"6","color":"#000000","latex":"m_{n}=\\frac{m_{d}}{\\left|m_{d}\\right|}","hidden":true},{"type":"text","id":"292","folderId":"6","text":"\"spring constant\" for each member"},{"type":"expression","id":"290","folderId":"6","color":"#c74440","latex":"m_{k}=\\frac{1}{\\left|m_{d}\\right|}"},{"type":"text","id":"294","folderId":"6","text":"displacement to force transform"},{"type":"expression","id":"296","folderId":"6","color":"#000000","latex":"m_{kn}=m_{k}\\cdot m_{n}","hidden":true},{"type":"expression","id":"41","folderId":"6","color":"#388c46","latex":"m_{t}\\left(i,v\\right)=m_{kn}\\left[i\\right]\\cdot\\left(m_{n}\\left[i\\right]\\cdot v\\right)"},{"type":"expression","id":"42","color":"#6042a6"},{"type":"folder","id":"55","title":"Conjugate gradient solver"},{"type":"text","id":"171","folderId":"55","text":"https://en.wikipedia.org/wiki/Conjugate_gradient_method\n\nImplemented using a counter. To make it fast on Desmos, do stuff in as few \"clock cycles\" as possible (1 in this case)."},{"type":"expression","id":"172","folderId":"55","color":"#2d70b3"},{"type":"expression","id":"96","folderId":"55","color":"#2d70b3","latex":"c_{gReset}=c_{gCounter}\\to0,\\ r_{cg}\\to\\left[\\left(\\infty,\\infty\\right)\\right]"},{"type":"expression","id":"113","folderId":"55","color":"#2d70b3","latex":"c_{gTolerance}=10^{-6}"},{"type":"expression","id":"109","folderId":"55","color":"#388c46"},{"type":"text","id":"108","folderId":"55","text":"Initialization"},{"type":"expression","id":"169","folderId":"55","color":"#000000","latex":"x_{cgInit}=\\left[F_{V}\\left[i\\right]\\operatorname{for}i=\\left[N_{fixed}+1...N\\right]\\right]","hidden":true},{"type":"expression","id":"80","folderId":"55","color":"#388c46","latex":"c_{gInit}=x_{cg}\\to x_{cgInit},\\ r_{cg}\\to x_{cgInit},\\ p_{cg}\\to x_{cgInit}"},{"type":"expression","id":"110","folderId":"55","color":"#6042a6"},{"type":"text","id":"260","folderId":"55","text":"Stiffness-vector product"},{"type":"expression","id":"255","folderId":"55","color":"#388c46","latex":"p_{cgPad}=\\left[\\left\\{i>N_{fixed}:\\ p_{cg}\\left[i-N_{fixed}\\right],\\ \\left(0,0\\right)\\right\\}\\operatorname{for}i=\\left[1...N\\right]\\right]","hidden":true},{"type":"expression","id":"254","folderId":"55","color":"#2d70b3","latex":"p_{cgDiff}=p_{cgPad}\\left[A_{I}.x\\right]-p_{cgPad}\\left[A_{I}.y\\right]","hidden":true},{"type":"expression","id":"256","folderId":"55","color":"#6042a6","latex":"A_{pCg}=\\left[\\sum_{j=A_{start}\\left[i\\right]}^{A_{end}\\left[i\\right]}\\left(m_{t}\\left(j,\\ p_{cgDiff}\\left[j\\right]\\right)\\right)\\operatorname{for}i=\\left[N_{fixed}+1...N\\right]\\right]","hidden":true},{"type":"expression","id":"261","folderId":"55","color":"#2d70b3"},{"type":"text","id":"166","folderId":"55","text":"Iteration step"},{"type":"expression","id":"168","folderId":"55","color":"#6042a6","latex":"\\alpha_{cg}=\\frac{\\operatorname{total}\\left(r_{cg}\\cdot r_{cg}\\right)}{\\operatorname{total}\\left(p_{cg}\\cdot A_{pCg}\\right)}"},{"type":"expression","id":"167","folderId":"55","color":"#388c46","latex":"r_{cg1}\\left(\\right)=r_{cg}-\\alpha_{cg}\\cdot A_{pCg}"},{"type":"expression","id":"162","folderId":"55","color":"#6042a6","latex":"c_{gIter}=x_{cg}\\to x_{cg}+\\alpha_{cg}\\cdot p_{cg},\\ p_{cg}\\to r_{cg1}\\left(\\right)+\\frac{\\operatorname{total}\\left(\\left|r_{cg1}\\left(\\right)\\right|^{2}\\right)}{\\operatorname{total}\\left(r_{cg}\\cdot r_{cg}\\right)}\\cdot p_{cg},\\ r_{cg}\\to r_{cg1}\\left(\\right)"},{"type":"expression","id":"111","folderId":"55","color":"#000000"},{"type":"text","id":"93","folderId":"55","text":"Looping and stopping criteria"},{"type":"expression","id":"95","folderId":"55","color":"#c74440","latex":"c_{gCounter}=45","slider":{"hardMin":true,"min":"0","step":"1"}},{"type":"expression","id":"97","folderId":"55","color":"#388c46","latex":"c_{gStep}=\\left\\{c_{gCounter}<1:\\ c_{gInit},\\ c_{gIter}\\right\\}"},{"type":"expression","id":"94","folderId":"55","color":"#388c46","latex":"c_{gMainStep}=c_{gStep},\\ c_{gCounter}\\to c_{gCounter}+1"},{"type":"expression","id":"301","folderId":"55","color":"#388c46","latex":"c_{gError}=\\sqrt{\\operatorname{mean}\\left(r_{cg}\\cdot r_{cg}\\right)}"},{"type":"expression","id":"101","folderId":"55","color":"#c74440","latex":"c_{gMain}=c_{gMainStep}\\left\\{c_{gError}>c_{gTolerance}\\right\\}"},{"type":"expression","id":"300","folderId":"55","color":"#2d70b3"},{"type":"folder","id":"299","title":"[DON'T OPEN]\n\nVariables for conjugate gradient","hidden":true,"collapsed":true},{"type":"expression","id":"57","folderId":"299","color":"#000000","latex":"x_{cg}=\\left[\\left(-6.304813348859328,-4.993735944254612\\right),\\left(-4.994560316526561,-1.4029426071552573\\right),\\left(-4.30823107323691,-10.590527623495676\\right),\\left(-2.9702610022420908,-5.521545407833697\\right),\\left(-11.716371033151228,-5.933205790539359\\right),\\left(-12.613171815106597,-4.327408605633491\\right),\\left(-4.7043405697957175,-13.091258625690186\\right),\\left(-4.570691885814429,-8.455120980380807\\right),\\left(-11.574515794012894,-5.605074138380852\\right),\\left(-10.671850164910312,-14.447297751994647\\right),\\left(-10.983298860020163,-24.003586239797148\\right),\\left(-10.21518637133411,-28.275763285252477\\right),\\left(-9.189004028875758,-28.28614060354939\\right),\\left(-8.78464419575185,-22.34875278518413\\right),\\left(-8.450148980052788,-14.835541606116747\\right),\\left(-8.297886568349403,-9.092285316825208\\right),\\left(-4.351314545612563,-14.911412076894743\\right),\\left(-5.9134280095408,-24.07525364516939\\right),\\left(-8.295669821680807,-27.53448754089049\\right),\\left(-10.925961883531636,-28.396168692095507\\right),\\left(-13.290627863677601,-22.44241623085661\\right),\\left(-14.017105310595618,-15.397591895858854\\right),\\left(-6.259237243556553,-25.80305724631048\\right)\\right]","hidden":true},{"type":"expression","id":"60","folderId":"299","color":"#388c46","latex":"r_{cg}=\\left[\\left(5.281767737476642\\cdot 10^{-7},1.3211583751752764\\cdot 10^{-7}\\right),\\left(6.134515697261369\\cdot 10^{-8},-5.23246319372313\\cdot 10^{-7}\\right),\\left(4.284322043974447\\cdot 10^{-8},7.117343295990224\\cdot 10^{-8}\\right),\\left(-5.643380616630489\\cdot 10^{-7},3.286298283881159\\cdot 10^{-7}\\right),\\left(-4.358036106540097\\cdot 10^{-7},4.1803776252178874\\cdot 10^{-7}\\right),\\left(-2.5150465048057825\\cdot 10^{-7},-5.677291416356153\\cdot 10^{-7}\\right),\\left(-8.608829235541735\\cdot 10^{-8},4.969402509042872\\cdot 10^{-7}\\right),\\left(7.558974735369438\\cdot 10^{-7},7.510075972984538\\cdot 10^{-7}\\right),\\left(1.30291299924868\\cdot 10^{-7},3.3936073990665906\\cdot 10^{-8}\\right),\\left(-4.553262477784412\\cdot 10^{-8},-4.622027210048699\\cdot 10^{-8}\\right),\\left(-6.98684188580858\\cdot 10^{-7},-7.106236885848258\\cdot 10^{-7}\\right),\\left(-1.494970433338794\\cdot 10^{-7},4.3103319706903723\\cdot 10^{-7}\\right),\\left(7.178009498884064\\cdot 10^{-7},-2.1183010113231974\\cdot 10^{-7}\\right),\\left(1.7009130440093677\\cdot 10^{-7},-6.631256179388104\\cdot 10^{-7}\\right),\\left(1.3355672908900107\\cdot 10^{-9},-1.1464680728545243\\cdot 10^{-7}\\right),\\left(-9.223730693102556\\cdot 10^{-7},-8.579886236283204\\cdot 10^{-7}\\right),\\left(8.64544990704866\\cdot 10^{-7},7.614465428729985\\cdot 10^{-8}\\right),\\left(-3.835761933423188\\cdot 10^{-7},6.800672824906036\\cdot 10^{-7}\\right),\\left(-3.3105473798738855\\cdot 10^{-7},-1.8070652319119828\\cdot 10^{-7}\\right),\\left(-3.230307726151479\\cdot 10^{-8},-4.80847820169876\\cdot 10^{-7}\\right),\\left(2.1348407226030421\\cdot 10^{-7},6.615649650647116\\cdot 10^{-7}\\right),\\left(3.200048309980363\\cdot 10^{-7},-1.5340772046297856\\cdot 10^{-7}\\right),\\left(-1.2693741352555227\\cdot 10^{-7},5.725972272690348\\cdot 10^{-7}\\right)\\right]","hidden":true},{"type":"expression","id":"62","folderId":"299","color":"#000000","latex":"p_{cg}=\\left[\\left(5.586949087445534\\cdot 10^{-7},1.302961705884582\\cdot 10^{-7}\\right),\\left(1.330491632033425\\cdot 10^{-7},-4.995796367435664\\cdot 10^{-7}\\right),\\left(8.901529739769091\\cdot 10^{-8},3.635033415102349\\cdot 10^{-7}\\right),\\left(-5.875734832565171\\cdot 10^{-7},2.4487753500510365\\cdot 10^{-7}\\right),\\left(-4.961126545122245\\cdot 10^{-7},4.1211703695786753\\cdot 10^{-7}\\right),\\left(-3.025223774530935\\cdot 10^{-7},-5.68418024904149\\cdot 10^{-7}\\right),\\left(-1.31961436708261\\cdot 10^{-7},4.870645770218731\\cdot 10^{-7}\\right),\\left(9.659741246442786\\cdot 10^{-7},6.359451692763464\\cdot 10^{-7}\\right),\\left(2.0766551519171266\\cdot 10^{-7},-2.5429021861782675\\cdot 10^{-8}\\right),\\left(-5.93460353148807\\cdot 10^{-8},-5.665842262729378\\cdot 10^{-8}\\right),\\left(-7.456192066537893\\cdot 10^{-7},-6.610899331233823\\cdot 10^{-7}\\right),\\left(-2.436559984032963\\cdot 10^{-7},2.583714554225577\\cdot 10^{-7}\\right),\\left(5.99279974411072\\cdot 10^{-7},-6.080348375753894\\cdot 10^{-8}\\right),\\left(1.6924825568886694\\cdot 10^{-7},-4.276100092661126\\cdot 10^{-7}\\right),\\left(1.085065962081283\\cdot 10^{-8},-2.6888806459264755\\cdot 10^{-7}\\right),\\left(-9.836808193744593\\cdot 10^{-7},-9.908383014107223\\cdot 10^{-7}\\right),\\left(9.911450269515674\\cdot 10^{-7},8.283744805288021\\cdot 10^{-8}\\right),\\left(-3.0873218941505767\\cdot 10^{-7},6.439549846422941\\cdot 10^{-7}\\right),\\left(-4.3054904718435004\\cdot 10^{-7},-2.0378576839120587\\cdot 10^{-7}\\right),\\left(-1.5607770859031352\\cdot 10^{-7},-3.968999326902715\\cdot 10^{-7}\\right),\\left(1.4928691488293945\\cdot 10^{-7},6.698155936651237\\cdot 10^{-7}\\right),\\left(2.865576238061149\\cdot 10^{-7},-1.9733566122840932\\cdot 10^{-7}\\right),\\left(5.866870245411748\\cdot 10^{-8},5.592338047401767\\cdot 10^{-7}\\right)\\right]","hidden":true},{"type":"expression","id":"65","color":"#388c46"},{"type":"folder","id":"119","title":"Get node deflection and member forces"},{"type":"text","id":"176","folderId":"119","text":"deflection - zero at fixed nodes, solver result at free nodes"},{"type":"expression","id":"122","folderId":"119","color":"#6042a6","latex":"U=\\left[\\left\\{i\\le N_{fixed}:\\ \\left(0,0\\right),\\ x_{cg}\\left[i-N_{fixed}\\right]\\right\\}\\operatorname{for}i=\\left[1...N\\right]\\right]","hidden":true},{"type":"text","id":"178","folderId":"119","text":"member force: projection of deflection on unit direction, normalized by member length"},{"type":"expression","id":"120","folderId":"119","color":"#2d70b3","latex":"M_{F}=\\frac{P\\left[A_{I}.y\\right]-P\\left[A_{I}.x\\right]}{\\left|P\\left[A_{I}.y\\right]-P\\left[A_{I}.x\\right]\\right|^{2}}\\cdot\\left(U\\left[A_{I}.y\\right]-U\\left[A_{I}.x\\right]\\right)"},{"type":"expression","id":"43","color":"#000000"},{"type":"folder","id":"208","title":"Helper functions"},{"type":"text","id":"252","folderId":"208","text":"linear time prefix sum by @fad"},{"type":"expression","id":"209","folderId":"208","color":"#2d70b3","latex":"p_{refixSum}\\left(x\\right)=\\left\\{x.\\operatorname{count}\\le1:x,\\left(\\left\\{\\operatorname{mod}\\left(i,2\\right)=0:0,x\\left[i\\right]\\right\\}+\\left\\{i=1:0,y\\left[\\frac{i}{2}\\right]\\right\\}\\operatorname{for}i=\\left[1...x.\\operatorname{count}\\right]\\right)\\operatorname{with}y=p_{refixSum}\\left(x\\left[2j-1\\right]+x\\left[2j\\right]\\operatorname{for}j=\\left[1...\\operatorname{floor}\\left(\\frac{x.\\operatorname{count}}{2}\\right)\\right]\\right)\\right\\}"},{"type":"expression","id":"114","color":"#388c46"}],"ticker":{"handlerLatex":"c_{gMain}","minStepLatex":"0","playing":true,"open":true}},"includeFunctionParametersInRandomSeed":true,"doNotMigrateMovablePointStyle":true}}